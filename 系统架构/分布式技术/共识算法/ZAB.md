## ZAB 一致性协议

ZAB ：是为 Zookeeper 专门设计的一致性算法。保证 Zookeeper 在分布式环境下的一致性。

两个核心点：

1. 消息广播
2. 崩溃恢复

Zookeeper 主备模式，只有主节点才能写入数据。基于**消息广播**，采用 **2PC** 的方式保证数据写入一致性。

细节上使用：写入请求封装成一个事务，进行commit ，超过半数follow节点成功，这次事务提交视为成功

### 2pc 存在的问题

* 单点问题

> 通过奔溃恢复解决

* 阻塞问题

> 通过队列解决了 2PC 的同步阻塞问题

